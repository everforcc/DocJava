<span  style="font-family: Simsun,serif; font-size: 17px; ">

[TOC]

### 1. 什么是消息队列

- **消息队列（Message Queue）**：是一种用于在应用程序之间传递消息的通讯方式，消息队列允许应用程序之间异步的发送和接收消息，并且不需要直接连接对方
- **消息（Message）**：是指在应用间传递的数据。可以是任何类型
- **队列（Queue）**：可以说是一个数据结构，可以存储数据，先进先出

### 2. 应用场景

#### 2.1 应用解耦-订单系统

- 没有mq

~~~
订单系统 -> 库存系统
订单系统 -> 物流系统
~~~

- 有mq

~~~
订单系统 -> 写入 mq
mq -> 库存系统
mq -> 物流系统
这样即使，后两个系统挂了，也不影响，恢复后还能重新消费数据
~~~

#### 2.2 异步提速-注册

- 没有mq

~~~
注册 -> 入库 -> 邮件 -> 短信
~~~

- 有mq

~~~
注册 -> 入库 -> mq
mq -> 邮件
mq -> 短信
~~~

#### 2.3 流量削峰-秒杀

- 没有mq

~~~
用户请求(每秒1w) -> 订单服务（每秒1k）
~~~

- 有mq

~~~
用户请求(每秒1w) ->mq
mq -> 订单服务（每秒拉取1k）
~~~

### 3. 有什么缺点

- 1.降低可用性
    - 外部依赖越多，越容易刮掉
- 2系统复杂度提高
    - 使用MQ后可能需要保证消息没有被重复消费，丢失，顺序等
- 3 一致性
    - 多个系统都要处理 ABD成功
    - C失败
    - 导致数据不一致

</span> 