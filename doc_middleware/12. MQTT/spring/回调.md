<span  style="font-family: Simsun,serif; font-size: 17px; ">

[TOC]

- [参考文档](https://askemq.com/t/topic/9667)

### 回调

~~~
            mqttClient.setCallback(new MqttCallback() {
                @Override
                public void connectionLost(Throwable cause) {

                }

                @Override
                public void messageArrived(String topic, MqttMessage message) throws Exception {
                    System.out.println("messageArrived: " + topic);
                    System.out.println("messageArrived: " + new String(message.getPayload()));
                }

                @Override
                public void deliveryComplete(IMqttDeliveryToken token) {
                    if (token.isComplete()) {
                        try {
                            // 如果消息发送成功，这里message是null
                            System.out.println("token.getMessage(): " + token.getMessage() + " ,token.getMessageId(): " + token.getMessageId());
                            if (messageId == token.getMessageId()) {
                                System.out.println("消息确认发布成功");
                            }
                        } catch (MqttException e) {
                            e.printStackTrace();
                        }
                    } else {
                        // todo 没确定如何模拟
                        System.out.println("token.getException(): " + token.getException());
                    }
                }
            });
~~~

</span>