<span  style="font-family: Simsun,serif; font-size: 17px; ">

[TOC]

### zn_charge_area 充电区

| 字段        | 类型         | 描述       |
| ----------- | ------------ | ---------- |
| name        | varchar(512) | 充电区名称 |
| description | varchar(512) | 描述       |

- name 不能重复
- 如果绑定了充电桩，则不能删除

### zn_charge_device 充电桩

| 字段          | 类型          | 描述              |
| ------------- | ------------- | ----------------- |
| area_id       | bigint20      | zn_charge_area.id |
| sn            | varchar(32)   | 设备编号          |
| name          | varchar(512)  | 充电桩名称        |
| locaiton      | varchar(512)  | 位置              |
| man_facturer  | varchar(512)  | 厂商名称          |
| type          | ---           | 充电桩类型        |
| sim           | varchar(32)   | sim 卡号          |
| port_num      | int           | 端口数            |
| status_use    | int           | 使用状态          |
| status_can    | int           | 是否可用          |
| status_online | int           | 充电桩状态在线    |
| last_heart    | ---           | 最后心跳时间      |
| count_fee     | decimal(10,2) | 累计收费          |
| count_hour    | int           | 累计充电时长      |
| count_use     | int           | 累计充电次数      |

### zn_charge_fee 充电桩计费设置

| 字段    | 类型          | 描述                 |
| ------- | ------------- | -------------------- |
| area_id | bigint20      | zn_charge_area.id    |
| type    | int           | 1 时,2 度            |
| base    | decimal(10,2) | 基础费 元/小时 元/度 |
| serve   | decimal(10,2) | 服务费               |
| total   | decimal(10,2) | 总计费用             |

### zn_charge_duration 充电桩时长设置

| 字段    | 类型     | 描述                 |
| ------- | -------- | -------------------- |
| area_id | bigint20 | zn_charge_area.id    |
| type    | int      | 1 时,2 度            |
| level   | int      | 1 多少小时，2 多少度 |

### zn_charge_user 充电用户

- sys_user

| 字段        | 类型          | 描述        |
| ----------- | ------------- | ----------- |
| use_id      | bigint20      | sys_user.id |
| balance     | decimal(10,2) | 余额        |
| description | varchar(512)  | 描述        |

### zn_charge_user_balance_log 充电用户余额记录

| 字段     | 类型          | 描述                                              |
| -------- | ------------- | ------------------------------------------------- |
| use_id   | bigint20      | sys_user.id                                       |
| type     | int           | 1 充值 2 使用 3 退费 4 退款                       |
| amount   | decimal(10,2) | 变动金额                                          |
| source   | int           | 1 小程序 2 后台                                   |
| order_id | bigint20      | 当前为充值时，为订单号，其余为 zn_charge_order.id |

### zn_charge_order 充电订单

| 字段          | 类型          | 描述                                  |
| ------------- | ------------- | ------------------------------------- |
| id            | bigint20      | 订单号                                |
| sn            | varchar(32)   | 设备编号                              |
| user_id       | bigint20      | 用户 id                               |
| charge_type   | int           | 本次选择的充电类型 1 时,2 度          |
| pre_base      | int           | 充电时长/充电多少度/0 充满自停        |
| pre_fee       | decimal(10,2) | 预扣费                                |
| status        | int           | 1 创建中 2 充电中 3 充电完成 4 异常？ |
| time_start    | datetime      | 开始充电时间                          |
| time_end      | datetime      | 结束充电时间                          |
| time_duration | varchar(32)   | 充电时长                              |
| fee_real      | decimal(10,2) | 实际消费                              |
| fee_base      | decimal(10,2) | 基础费用                              |
| fee_serve     | decimal(10,2) | 服务费                                |
| elec_hour     | decimal(10,2) | 电量费率(元/度)                       |
| elec_use      | decimal(10,2) | 实际用电量                            |
| end_type      | int           | 0-12，参考下面                        |
| id_card       | varchar(32)   | 身份证号                              |
| vin           | varchar(32)   | 车辆 AIN 吗                           |
| car_card      | varchar(32)   | 车牌号                                |
| cell_type     | varchar(32)   | 电池型号                              |

```
0 ：时间到正常结束；
1 ：电能用完结束；
2 ：钱用完结束；
3 ：充满自停浮充时间到结束；(对应平台充满自停(1))4 ：充满自停达到最小功率结束；(对应平台充满自停(2))5 ：充满自停达到功率恒定结束；(对应平台充满自停(3))6 ：无负载结束 (用于开始充电时的负载检测)；7 ：超负载结束；
8 ：充电器移除结束；
9 ：超出最大充电时长结束
10 ：用户微信主动结束
11 ：从机通信失败
12 远程主动断电
```

### zn_charge_device_log 设备日志-todo

| 字段    | 类型        | 描述                               |
| ------- | ----------- | ---------------------------------- |
| id      | bigint20    | id                                 |
| sn      | varchar(32) | 设备号                             |
| elec    | int         | 0 设备正常 1：设备有过断电现象     |
| port    | int         |                                    |
| network | int         | 0 设备网络正常 1：设备有过断网现象 |

```
port
0 设备端口正常
1：设备端口出现异常(无继电器黏连)
2：出现继电器黏连，端口无其它问题。3：出现端口问题，同时也有继电器黏连
```

### zn_charge_byte_log 充电订单字节日志 - todo

| 字段     | 类型         | 描述          |
| -------- | ------------ | ------------- |
| id       | bigint20     | id            |
| sn       | varchar(32)  | 设备号        |
| busi_id  | bigint20     | 订单号        |
| step     | varchar(32)  | 步骤号        |
| rs       | varchar(32)  | r 接收 s 发送 |
| byte_hex | varchar(512) | 字节          |

### zn_charge_device_port_log 充电订单端口日志 - todo

| 字段     | 类型        | 描述     |
| -------- | ----------- | -------- |
| id       | bigint20    | id       |
| sn       | varchar(32) | 设备号   |
| order_id | bigint20    | 订单号   |
| port     | int         | 端口号   |
| w        | double      | 平均功率 |

</span>
