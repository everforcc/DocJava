<span  style="font-family: Simsun,serif; font-size: 17px; ">

## 🏗️ 物联网 (IoT) 解决方案架构概览

您的系统由三个核心自主开发层组成，并要求所有设备必须经过激活才能使用。

---

### 1. 🔌 物理设备 (Device Layer)

* **自主开发**：设备固件和硬件均由内部团队完成。
* **唯一标识**：每个设备都拥有一个**唯一的序列号 (SN)**。
* **使用限制**：设备在连接到服务之前，必须完成激活过程。

### 2. 🖥️ 本地服务 (Edge/Local Service Layer)

* **自主开发**：由内部团队完成。
* **技术栈**：基于 **Java Spring Boot** 框架。
* **项目特点**：可能包含**多个项目**，提供模块化的边缘服务功能。

### 3. ☁️ 云服务 (Cloud Service Layer)

* **自主开发**：由内部团队完成。
* **核心功能**：负责设备管理、数据存储、数据分析、远程控制，以及**执行设备激活和授权**等核心业务逻辑。

---

## 🔒 关键要求：设备身份认证参数解析

您提到的 $PK$、$DN$、$DS$ 和 $PS$ 是物联网安全认证的关键。

| 参数   | 缩写 | 级别  | 描述                       |
|:-----|:---|:----|:-------------------------|
| 产品密钥 | PK | 产品级 | 标识**一类**设备的型号或功能。        |
| 设备名称 | DN | 设备级 | 标识**一台**具体的物理设备（通常使用SN）。 |
| 设备密钥 | DS | 设备级 | 设备的“密码”，用于认证，安全性最高。      |
| 产品密钥 | PS | 产品级 | 用于动态注册/激活模式下的产品凭证。       |

---

## 🔄 两种认证模式的应用

设备的接入方式主要有两种，它们决定了 $DS$ 是如何被设备获取和使用的。

### 1. 🥇 一机一密 (PK + DN + DS) — 推荐模式

这是最安全和最常见的认证模式。

* **含义：** 每个物理设备都拥有**独一无二**的 $DS$。
* **烧录信息：** 在设备出厂时，设备内置烧录了 $PK$、$DN$ (SN)、以及该 $DN$ 对应的 $DS$。
* **连接流程：**
    1. 设备使用 $PK$ 和 $DN$ 向云服务声明身份。
    2. 设备使用 $DS$ **计算签名** (Signature)，发起连接请求。
    3. 云平台根据 $PK$ 和 $DN$ 查找存储的 $DS$ 并进行签名比对。
    4. 签名一致，则认证通过，**设备状态必须为“已激活”才能接入**。

### 2. 🥈 一型一密 (PK + PS) — 动态注册模式

这种模式适用于在批量生产中，无法为每台设备预先烧录 $DS$ 的场景。

* **含义：** 同一批次的设备共享**相同**的 $PK$ 和 $PS$。
* **烧录信息：** 设备出厂时，仅烧录 $PK$ 和 $PS$。**不烧录** $DS$。
* **连接流程：**
    1. **激活/注册请求：** 设备首次联网时，使用 $PK$、$PS$ 和其唯一的 $DN$ (SN) 向云平台发起**激活请求**。
    2. **验证与颁发：** 云平台验证 $PK$ 和 $PS$ 的合法性，并为该 $DN$ **动态生成**一个唯一的 $DS$。
    3. **设备保存：** 云平台将 $DS$ 返回给设备，设备将其安全存储，并将状态设置为“已激活”。
    4. **后续连接：** 设备转为**“一机一密”模式**（即使用 $PK$ + $DN$ + $DS$）进行所有后续的安全连接。

---

您希望我针对**“一机一密”模式下的签名计算（如何使用 $DS$ 进行加密认证）** 提供一个技术说明吗？

</span>