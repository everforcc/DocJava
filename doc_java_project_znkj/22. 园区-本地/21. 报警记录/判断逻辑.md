<span  style="font-family: Simsun,serif; font-size: 17px; ">

- 故障判断逻辑
- 设备会故障，每一分钟检测一次，如果连续x分钟都故障，那么认为设备故障。如果x内有一个正常，那么认为设备正常。
- 故障记录表device_alerts ：主要字段，设备device_id，设备类型device_type,设备是否故障 current_status（0正常，1故障），临时状态
  temp_status（0正常，1故障），临时状态更新时间 temp_status_time=now()，设备故障时间 alert_time。
- 逻辑：
- 按照device_type 进行分组，对每个分组进行判断
- 会返回一个设备故障列表，如果列表长度为0，那么认为设备正常。如果列表长度不为0，那么认为设备故障。
- 如果列表不是空，那么列表中的就是故障设备。
    - 如果 device_alerts 中，不存在 device_id，那么就新增一条
    - 如果 device_alerts 中，存在 device_id，并且，设备为正常状态0，那么就更新这条记录 temp_status状态为1，并且更新时间
    - 如果 device_alerts 中，存在 device_id，并且，设备为故障状态 temp_status 1，那么久不做处理
    - 如果 当前状态 temp_status为 故障，判断是否已经超过x分钟，如果超过x分钟，那么就 将current_status 修改为1，
- 列表中不存在的设备，就是正常设备，将 device_alerts 中的temp_status 改为0，将current_status改为0，将alert_time改为null

### temp_status

- 自增，临时状态，如果0正常
- 每次检测，如果设备故障，那么将temp_status自增1，如果设备正常，那么将temp_status重置为0

</span>