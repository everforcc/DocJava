<span  style="font-family: Simsun,serif; font-size: 17px; ">

### 金额计算

~~~
(total-计次卡)*折扣-立减 = 
~~~

### 发券

- [ ] 有限制次数，每个会员只能发几张
- [ ] 券和商品
- [ ] 发券和用户需要是一一对应的

### app接口流程

- 组织完订单数据之后
- 返回优惠券信息
- [ ] 选择优惠券，折扣信息
    - [ ] 新增字段
    - [ ] 商品ID
    - [ ] 商品名称
    - [ ] 商品金额
- submit后，折扣信息保存，但是优惠券信息不要保存，因为会有支付失败的情况
- [ ] 支付完回写的接口需要确定一下
- [ ] 不存在并发的情况，所以不用额外加锁处理

### 删除订单

- 应该只能成功或者取消才能删除
- 如果是其他状态则不能删除
- [ ] 业务上哪种状态，待确定

### 超时

- 超时未支付走定时任务取消
    - 撤回积分
    - 优惠券
    - 库存

### 日志

- 日志逻辑处理掉

</span>