# 13.1.1. 线性结构知识点概述 - Java代码示例

## 线性表接口定义

```java
/**
 * 线性表接口
 * 定义线性表的基本操作
 */
public interface LinearList<T> {
    /**
     * 判断线性表是否为空
     */
    boolean isEmpty();
    
    /**
     * 获取线性表长度
     */
    int length();
    
    /**
     * 获取指定位置的元素
     */
    T get(int index);
    
    /**
     * 设置指定位置的元素
     */
    void set(int index, T element);
    
    /**
     * 在指定位置插入元素
     */
    void insert(int index, T element);
    
    /**
     * 删除指定位置的元素
     */
    T remove(int index);
    
    /**
     * 查找元素的位置
     */
    int indexOf(T element);
    
    /**
     * 清空线性表
     */
    void clear();
}
```

## 顺序存储实现

```java
/**
 * 顺序表实现
 * 使用数组实现线性表
 */
public class ArrayList<T> implements LinearList<T> {
    private Object[] data;  // 存储数据的数组
    private int size;       // 当前元素个数
    private int capacity;   // 数组容量
    
    /**
     * 构造函数
     */
    public ArrayList() {
        this(10);  // 默认容量为10
    }
    
    public ArrayList(int capacity) {
        this.capacity = capacity;
        this.data = new Object[capacity];
        this.size = 0;
    }
    
    @Override
    public boolean isEmpty() {
        return size == 0;
    }
    
    @Override
    public int length() {
        return size;
    }
    
    @Override
    @SuppressWarnings("unchecked")
    public T get(int index) {
        if (index < 0 || index >= size) {
            throw new IndexOutOfBoundsException("索引越界: " + index);
        }
        return (T) data[index];
    }
    
    @Override
    public void set(int index, T element) {
        if (index < 0 || index >= size) {
            throw new IndexOutOfBoundsException("索引越界: " + index);
        }
        data[index] = element;
    }
    
    @Override
    public void insert(int index, T element) {
        if (index < 0 || index > size) {
            throw new IndexOutOfBoundsException("索引越界: " + index);
        }
        
        // 检查容量，如果不够则扩容
        if (size >= capacity) {
            resize();
        }
        
        // 将index及之后的元素向后移动
        for (int i = size; i > index; i--) {
            data[i] = data[i - 1];
        }
        
        // 插入新元素
        data[index] = element;
        size++;
    }
    
    @Override
    @SuppressWarnings("unchecked")
    public T remove(int index) {
        if (index < 0 || index >= size) {
            throw new IndexOutOfBoundsException("索引越界: " + index);
        }
        
        T element = (T) data[index];
        
        // 将index之后的元素向前移动
        for (int i = index; i < size - 1; i++) {
            data[i] = data[i + 1];
        }
        
        size--;
        return element;
    }
    
    @Override
    public int indexOf(T element) {
        for (int i = 0; i < size; i++) {
            if (Objects.equals(data[i], element)) {
                return i;
            }
        }
        return -1;  // 未找到
    }
    
    @Override
    public void clear() {
        size = 0;
    }
    
    /**
     * 扩容操作
     */
    private void resize() {
        capacity *= 2;
        Object[] newData = new Object[capacity];
        System.arraycopy(data, 0, newData, 0, size);
        data = newData;
    }
    
    @Override
    public String toString() {
        StringBuilder sb = new StringBuilder();
        sb.append("[");
        for (int i = 0; i < size; i++) {
            sb.append(data[i]);
            if (i < size - 1) {
                sb.append(", ");
            }
        }
        sb.append("]");
        return sb.toString();
    }
}
```

## 链式存储实现

```java
/**
 * 链表节点
 */
class ListNode<T> {
    T data;
    ListNode<T> next;
    
    public ListNode(T data) {
        this.data = data;
        this.next = null;
    }
    
    public ListNode(T data, ListNode<T> next) {
        this.data = data;
        this.next = next;
    }
}

/**
 * 链表实现
 * 使用指针实现线性表
 */
public class LinkedList<T> implements LinearList<T> {
    private ListNode<T> head;  // 头节点
    private int size;          // 元素个数
    
    public LinkedList() {
        this.head = null;
        this.size = 0;
    }
    
    @Override
    public boolean isEmpty() {
        return size == 0;
    }
    
    @Override
    public int length() {
        return size;
    }
    
    @Override
    public T get(int index) {
        if (index < 0 || index >= size) {
            throw new IndexOutOfBoundsException("索引越界: " + index);
        }
        
        ListNode<T> current = head;
        for (int i = 0; i < index; i++) {
            current = current.next;
        }
        return current.data;
    }
    
    @Override
    public void set(int index, T element) {
        if (index < 0 || index >= size) {
            throw new IndexOutOfBoundsException("索引越界: " + index);
        }
        
        ListNode<T> current = head;
        for (int i = 0; i < index; i++) {
            current = current.next;
        }
        current.data = element;
    }
    
    @Override
    public void insert(int index, T element) {
        if (index < 0 || index > size) {
            throw new IndexOutOfBoundsException("索引越界: " + index);
        }
        
        ListNode<T> newNode = new ListNode<>(element);
        
        if (index == 0) {
            // 在头部插入
            newNode.next = head;
            head = newNode;
        } else {
            // 找到插入位置的前一个节点
            ListNode<T> current = head;
            for (int i = 0; i < index - 1; i++) {
                current = current.next;
            }
            newNode.next = current.next;
            current.next = newNode;
        }
        size++;
    }
    
    @Override
    public T remove(int index) {
        if (index < 0 || index >= size) {
            throw new IndexOutOfBoundsException("索引越界: " + index);
        }
        
        T element;
        if (index == 0) {
            // 删除头节点
            element = head.data;
            head = head.next;
        } else {
            // 找到要删除节点的前一个节点
            ListNode<T> current = head;
            for (int i = 0; i < index - 1; i++) {
                current = current.next;
            }
            element = current.next.data;
            current.next = current.next.next;
        }
        size--;
        return element;
    }
    
    @Override
    public int indexOf(T element) {
        ListNode<T> current = head;
        int index = 0;
        while (current != null) {
            if (Objects.equals(current.data, element)) {
                return index;
            }
            current = current.next;
            index++;
        }
        return -1;  // 未找到
    }
    
    @Override
    public void clear() {
        head = null;
        size = 0;
    }
    
    @Override
    public String toString() {
        StringBuilder sb = new StringBuilder();
        sb.append("[");
        ListNode<T> current = head;
        while (current != null) {
            sb.append(current.data);
            if (current.next != null) {
                sb.append(", ");
            }
            current = current.next;
        }
        sb.append("]");
        return sb.toString();
    }
}
```

## 测试代码

```java
/**
 * 线性结构测试类
 */
public class LinearStructureTest {
    public static void main(String[] args) {
        System.out.println("=== 顺序表测试 ===");
        testArrayList();
        
        System.out.println("\n=== 链表测试 ===");
        testLinkedList();
    }
    
    /**
     * 测试顺序表
     */
    public static void testArrayList() {
        ArrayList<Integer> list = new ArrayList<>();
        
        // 插入元素
        list.insert(0, 1);
        list.insert(1, 2);
        list.insert(2, 3);
        System.out.println("插入后: " + list);
        
        // 获取元素
        System.out.println("索引1的元素: " + list.get(1));
        
        // 设置元素
        list.set(1, 99);
        System.out.println("设置后: " + list);
        
        // 查找元素
        System.out.println("元素99的位置: " + list.indexOf(99));
        
        // 删除元素
        int removed = list.remove(1);
        System.out.println("删除的元素: " + removed);
        System.out.println("删除后: " + list);
    }
    
    /**
     * 测试链表
     */
    public static void testLinkedList() {
        LinkedList<String> list = new LinkedList<>();
        
        // 插入元素
        list.insert(0, "Hello");
        list.insert(1, "World");
        list.insert(2, "Java");
        System.out.println("插入后: " + list);
        
        // 获取元素
        System.out.println("索引1的元素: " + list.get(1));
        
        // 设置元素
        list.set(1, "Beautiful");
        System.out.println("设置后: " + list);
        
        // 查找元素
        System.out.println("元素Java的位置: " + list.indexOf("Java"));
        
        // 删除元素
        String removed = list.remove(1);
        System.out.println("删除的元素: " + removed);
        System.out.println("删除后: " + list);
    }
}
```

## 复杂度分析

### 顺序表（ArrayList）
- **插入操作**：O(n) - 需要移动元素
- **删除操作**：O(n) - 需要移动元素
- **查找操作**：O(n) - 需要遍历
- **访问操作**：O(1) - 直接通过索引访问
- **空间复杂度**：O(n)

### 链表（LinkedList）
- **插入操作**：O(1) - 只需要修改指针
- **删除操作**：O(1) - 只需要修改指针
- **查找操作**：O(n) - 需要遍历
- **访问操作**：O(n) - 需要从头开始遍历
- **空间复杂度**：O(n)

## 应用示例

```java
/**
 * 学生信息管理系统
 * 使用线性表管理学生信息
 */
class Student {
    private String name;
    private int age;
    private String id;
    
    public Student(String name, int age, String id) {
        this.name = name;
        this.age = age;
        this.id = id;
    }
    
    // getter和setter方法
    public String getName() { return name; }
    public void setName(String name) { this.name = name; }
    public int getAge() { return age; }
    public void setAge(int age) { this.age = age; }
    public String getId() { return id; }
    public void setId(String id) { this.id = id; }
    
    @Override
    public String toString() {
        return "Student{name='" + name + "', age=" + age + ", id='" + id + "'}";
    }
    
    @Override
    public boolean equals(Object obj) {
        if (this == obj) return true;
        if (obj == null || getClass() != obj.getClass()) return false;
        Student student = (Student) obj;
        return Objects.equals(id, student.id);
    }
}

/**
 * 学生管理系统
 */
public class StudentManagementSystem {
    private ArrayList<Student> students;
    
    public StudentManagementSystem() {
        this.students = new ArrayList<>();
    }
    
    /**
     * 添加学生
     */
    public void addStudent(Student student) {
        students.insert(students.length(), student);
    }
    
    /**
     * 根据学号查找学生
     */
    public Student findStudentById(String id) {
        for (int i = 0; i < students.length(); i++) {
            Student student = students.get(i);
            if (student.getId().equals(id)) {
                return student;
            }
        }
        return null;
    }
    
    /**
     * 删除学生
     */
    public boolean removeStudent(String id) {
        for (int i = 0; i < students.length(); i++) {
            Student student = students.get(i);
            if (student.getId().equals(id)) {
                students.remove(i);
                return true;
            }
        }
        return false;
    }
    
    /**
     * 显示所有学生
     */
    public void displayAllStudents() {
        System.out.println("所有学生信息:");
        for (int i = 0; i < students.length(); i++) {
            System.out.println((i + 1) + ". " + students.get(i));
        }
    }
    
    public static void main(String[] args) {
        StudentManagementSystem system = new StudentManagementSystem();
        
        // 添加学生
        system.addStudent(new Student("张三", 20, "001"));
        system.addStudent(new Student("李四", 21, "002"));
        system.addStudent(new Student("王五", 19, "003"));
        
        // 显示所有学生
        system.displayAllStudents();
        
        // 查找学生
        Student student = system.findStudentById("002");
        if (student != null) {
            System.out.println("找到学生: " + student);
        }
        
        // 删除学生
        boolean removed = system.removeStudent("002");
        System.out.println("删除结果: " + removed);
        
        // 再次显示所有学生
        system.displayAllStudents();
    }
}
```
