<span  style="font-family: Simsun,serif; font-size: 17px; ">

- ![加密技术与认证技术](./pic/加密技术与认证技术.png)

## 对称与非对称加密技术对比

### 基本对比表

| 特性     | 对称加密                      | 非对称加密                         |
| -------- | ----------------------------- | ---------------------------------- |
| 密钥关系 | 加密密钥=解密密钥（同一密钥） | 加密密钥 ≠ 解密密钥（公钥+私钥）   |
| 密钥数量 | n 个用户需要 n(n-1)/2 个密钥  | n 个用户需要 2n 个密钥             |
| 加密速度 | 快（MB/s 级别）               | 慢（KB/s 级别，慢 100-1000 倍）    |
| 密钥管理 | 困难（密钥分发困难）          | 简单（公钥可公开）                 |
| 密钥长度 | 较短（128-256 位）            | 较长（1024-4096 位）               |
| 典型算法 | DES、3DES、AES、RC4           | RSA、DSA、ECC                      |
| 主要用途 | 大量数据加密                  | 密钥交换、数字签名、小量数据加密   |
| 安全基础 | 密钥保密性                    | 数学难题（大整数分解、离散对数等） |

### 对称加密算法详解

| 算法 | 密钥长度                      | 分组长度 | 特点                   | 安全性               |
| ---- | ----------------------------- | -------- | ---------------------- | -------------------- |
| DES  | 56 位（实际 64 位，8 位校验） | 64 位    | 16 轮 Feistel 结构     | 已被破解，不推荐     |
| 3DES | 112 位或 168 位               | 64 位    | 三重 DES 加密          | 安全性提高，速度较慢 |
| AES  | 128/192/256 位                | 128 位   | SPN 结构，10/12/14 轮  | 目前最安全的对称算法 |
| RC4  | 可变                          | 流密码   | 流密码，WEP/WPA 中使用 | 存在安全漏洞         |

### 非对称加密算法详解

| 算法 | 密钥长度                     | 数学基础         | 主要用途                 | 特点                         |
| ---- | ---------------------------- | ---------------- | ------------------------ | ---------------------------- |
| RSA  | 1024/2048/4096 位            | 大整数因式分解   | 加密、数字签名、密钥交换 | 最广泛使用的非对称算法       |
| DSA  | 1024/2048/3072 位            | 离散对数问题     | 仅用于数字签名           | 不能用于加密                 |
| ECC  | 256 位（相当于 3072 位 RSA） | 椭圆曲线离散对数 | 加密、数字签名           | 密钥短、效率高，适合移动设备 |

### 混合加密系统

实际应用中通常采用混合方式：

1. 用非对称加密传输对称密钥（解决密钥分发问题）
2. 用对称加密传输大量数据（提高效率）
3. 兼顾安全性和效率

## 数字签名与信息摘要

### 数字签名基本概念

| 特性         | 说明                                 |
| ------------ | ------------------------------------ |
| 定义         | 用私钥对消息进行签名，用公钥验证签名 |
| 目的         | 消息认证、身份认证、不可否认性       |
| 原理         | 只有私钥持有者能生成有效签名         |
| 真实性       | 确认签名者身份                       |
| 完整性       | 确保数据未被篡改                     |
| 不可否认性   | 签名者不能否认                       |
| 不可伪造性   | 他人无法伪造签名                     |

### 数字签名过程

**签名过程：**
```
明文 → 哈希函数 → 消息摘要 → 私钥加密 → 数字签名
```

**验证过程：**
```
数字签名 → 公钥解密 → 消息摘要1
明文 → 哈希函数 → 消息摘要2
比较摘要1和摘要2是否相同
```

### 消息摘要（哈希函数）基本特性

| 特性     | 说明                                   |
| -------- | -------------------------------------- |
| 单向性   | 由摘要无法反推原文                     |
| 确定性   | 相同输入产生相同输出                   |
| 雪崩效应 | 输入微小变化导致输出巨大变化           |
| 抗碰撞性 | 很难找到产生相同摘要的不同输入         |

### 哈希算法对比表

| 算法     | 摘要长度 | 分组长度 | 安全性 | 应用场景                     |
| -------- | -------- | -------- | ------ | ---------------------------- |
| MD5      | 128 位   | 512 位   | 已破解 | 文件完整性校验（不推荐）     |
| SHA-1    | 160 位   | 512 位   | 已破解 | 不推荐                       |
| SHA-256  | 256 位   | 512 位   | 安全   | 推荐使用                     |
| SHA-384  | 384 位   | 1024 位  | 安全   | 高安全场景                   |
| SHA-512  | 512 位   | 1024 位  | 安全   | 高安全场景                   |

### 哈希函数应用场景

| 应用场景     | 说明                           |
| ------------ | ------------------------------ |
| 数字签名     | 对摘要签名而非原文（提高效率） |
| 密码存储     | 存储密码的哈希值               |
| 文件校验     | 验证文件完整性                 |
| 区块链       | 比特币等区块链技术             |
| HMAC         | 基于哈希的消息认证码           |

### MAC vs 数字签名对比

| 特性         | MAC（消息认证码） | 数字签名           |
| ------------ | ----------------- | ------------------ |
| 密钥类型     | 共享密钥          | 公私钥对           |
| 认证方式     | 双方认证          | 单方认证           |
| 不可否认性   | 无                | 有                 |
| 密钥管理     | 需要密钥分发      | 公钥可公开         |
| 典型算法     | HMAC              | RSA、DSA、ECC      |
| 适用场景     | 内部通信          | 公开环境、法律效力 |

## 数字证书应用

### 数字证书基本概念

| 项目     | 说明                       |
| -------- | -------------------------- |
| 定义     | 由权威机构签发的电子身份证明 |
| 作用     | 绑定实体身份与公钥         |
| 目的     | 解决公钥分发和认证问题     |
| 标准     | X.509                     |

### 数字证书内容（X.509 标准）

| 序号 | 内容             | 说明                     |
| ---- | ---------------- | ------------------------ |
| 1    | 版本号           | 证书版本信息             |
| 2    | 序列号           | 证书唯一标识             |
| 3    | 签名算法标识     | 使用的签名算法           |
| 4    | 颁发者（CA）信息 | 证书颁发机构信息         |
| 5    | 有效期           | 起始时间-结束时间        |
| 6    | 主体信息         | 证书持有者信息           |
| 7    | 主体公钥信息     | 证书持有者的公钥         |
| 8    | 扩展字段         | 扩展信息                 |
| 9    | CA 的数字签名    | 证书颁发机构的数字签名   |

### PKI 公钥基础设施组成

| 组件                   | 说明                     |
| ---------------------- | ------------------------ |
| CA（认证中心）         | 颁发和管理证书           |
| RA（注册中心）         | 身份审核和证书申请处理   |
| 证书库                 | 存储和分发证书           |
| 密钥备份与恢复         | 密钥管理服务             |
| 证书撤销列表（CRL）   | 已撤销证书清单           |
| OCSP（在线证书状态协议）| 实时查询证书状态         |

### CA 层次结构

```
根CA（Root CA）
├── 中间CA1（Intermediate CA）
│   ├── 子CA1-1
│   └── 子CA1-2
└── 中间CA2
    ├── 子CA2-1
    └── 子CA2-2
```

### 证书链验证步骤

| 步骤 | 验证内容                     |
| ---- | ---------------------------- |
| 1    | 检查证书格式和语法           |
| 2    | 检查证书有效期               |
| 3    | 检查证书撤销状态（CRL/OCSP） |
| 4    | 验证证书签名                 |
| 5    | 检查证书使用限制             |
| 6    | 构建并验证证书链             |
| 7    | 检查信任锚点                 |

### 证书类型分类

#### 按验证级别分类

| 类型 | 全称           | 验证内容         | 安全级别 |
| ---- | -------------- | ---------------- | -------- |
| DV   | 域名验证       | 验证域名所有权   | 低       |
| OV   | 组织验证       | 验证组织身份     | 中       |
| EV   | 扩展验证       | 最高级别验证     | 高       |

#### 按应用场景分类

| 类型             | 应用场景           | 说明                     |
| ---------------- | ------------------ | ------------------------ |
| SSL/TLS 证书     | 网站 HTTPS 加密    | 保护网站数据传输安全     |
| 代码签名证书     | 软件完整性验证     | 防止软件被篡改           |
| 电子邮件证书     | 邮件加密和签名     | 保护邮件安全             |
| 客户端证书       | 用户身份认证       | 用于用户身份验证         |

### 数字证书应用流程

1. **证书申请**：用户向 CA 提交证书申请
2. **身份验证**：RA 审核用户身份
3. **证书颁发**：CA 签发数字证书
4. **证书分发**：证书存储到证书库
5. **证书使用**：用户使用证书进行身份认证
6. **证书验证**：验证方验证证书有效性
7. **证书撤销**：必要时撤销证书（加入 CRL）

</span>
